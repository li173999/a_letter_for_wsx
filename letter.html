<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>王舒歆 亲启</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;500&display=swap');

        :root {
            --deep-space: #0a0821;
            --starlight: rgba(255, 255, 255, 0.9);
            --nebula-purple: rgba(128, 85, 230, 0.15);
            --cosmic-glow: rgba(188, 170, 255, 0.08);
            --star-accent: #b0a0ff;
            /* 降低容器不透明度，更透星空（0.55 -> 0.38）*/
            --letter-bg: rgba(10, 8, 33, 0.38);
            --letter-border: rgba(138, 130, 255, 0.2);
        }

        html, body {
            min-height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Noto Serif SC', 'Microsoft YaHei', serif;
            color: var(--starlight);
            background-color: var(--deep-space);
        }

        .bg-layer {
            position: fixed;
            inset: 0;
            background-image: url('assets/images/bg1.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            z-index: 0;
            will-change: transform;
        }

        .bg-overlay {
            position: fixed;
            inset: 0;
            background: linear-gradient(180deg, rgba(10,8,33,0.3), rgba(10,8,33,0.6));
            z-index: 1;
            pointer-events: none;
        }

        .star {
            position: fixed;
            left: 0;
            top: 0;
            width: var(--size, 2px);
            height: var(--size, 2px);
            background: radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,255,255,0.9) 38%, rgba(255,255,255,0.0) 70%);
            border-radius: 50%;
            z-index: 2;
            pointer-events: none;
            opacity: 0.7;
            /* 辉光更克制 */
            filter: drop-shadow(0 0 3px rgba(255,255,255,0.38));
            animation: twinkle var(--dur, 6s) ease-in-out infinite;
            animation-delay: var(--delay, 0s);
            will-change: opacity, transform;
        }

            /* 只有 “会闪”的星（.spark）才渲染光束 */
            .star.spark::before,
            .star.spark::after {
                content: '';
                position: absolute;
                left: 50%;
                top: 50%;
                transform: translate(-50%, -50%) rotate(var(--rot, 0deg)) scaleX(0.15);
                opacity: 0;
                border-radius: 999px;
                /* 细长光束：中间亮、两端透明 */
                background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.95) 48%, rgba(255,255,255,0) 100%);
                /* 更细、更优雅的辉光 */
                filter: drop-shadow(0 0 5px rgba(176,160,255,0.35));
                will-change: transform, opacity;
                animation: spikeTwinkle var(--dur, 6s) ease-in-out infinite;
                animation-delay: var(--delay, 0s);
            }

            /* 主光束尺寸（长度随星点大小放大，厚度更细） */
            .star.spark::before {
                width: calc(var(--size, 2px) * 7.5 * var(--spikeScale, 1));
                height: clamp(0.6px, calc(var(--size, 2px) * 0.42), 1.2px);
            }

            /* 次光束（仅在 .cross 下启用）；让它和主光束成近似直角但略有偏差，更自然 */
            .star.spark.cross::after {
                /* 让通用 keyframes 读取 --rot 变量，这里把 --rot 映射为 --rot2 */
                --rot: var(--rot2, 90deg);
                width: calc(var(--size, 2px) * 7.5 * var(--spikeScale, 1));
                height: clamp(0.6px, calc(var(--size, 2px) * 0.42), 1.2px);
            }

            /* 若不是 cross，则隐藏次光束 */
            .star.spark:not(.cross)::after {
                display: none;
            }

        /* 光束在亮度峰值出现，其他时刻收缩隐藏 */
        @keyframes spikeTwinkle {
            0%, 35%, 65%, 100% {
                opacity: 0;
                transform: translate(-50%, -50%) rotate(var(--rot, 0deg)) scaleX(0.15);
            }

            50% {
                opacity: 1;
                transform: translate(-50%, -50%) rotate(var(--rot, 0deg)) scaleX(1);
            }
        }

        /* 星点的亮暗（周期拉长） */
        @keyframes twinkle {
            0%, 100% {
                opacity: 0.42;
            }

            50% {
                opacity: 1;
            }
        }
        /* 流星容器（仅承载位移与旋转，子元素分别是星头与拖尾） */
        .meteor {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 3;
            will-change: transform;
            pointer-events: none;
        }
        /* 拖尾：远端透明 -> 靠近星头更亮；初始缩至0，随后由星头带出 */
        .meteor-tail {
            position: absolute;
            right: 0;
            top: 50%;
            height: 2px;
            width: 200px; /* 实际长度由JS设置 */
            transform: translateY(-50%) scaleX(0);
            transform-origin: right center; /* 以星头为原点，尾巴向后生长 */
            background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.9) 75%, rgba(255,255,255,1) 100%);
            border-radius: 2px;
            box-shadow: 0 0 10px rgba(255,255,255,0.6);
            opacity: 0;
            will-change: transform, opacity;
        }
        /* 星头：先出现，先消失 */
        .meteor-head {
            position: absolute;
            right: 0;
            top: 50%;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            transform: translateY(-50%);
            background: white;
            box-shadow: 0 0 8px #fff, 0 0 16px #fff, 0 0 24px rgba(176,160,255,0.75);
            opacity: 0;
            will-change: opacity;
        }

        .white-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            z-index: 1000;
            opacity: 1;
            transition: opacity 3s cubic-bezier(0.19, 1, 0.22, 1);
            pointer-events: none;
        }

        .content-wrapper {
            position: relative;
            z-index: 5;
            width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0;
            margin: 0;
            background-color: transparent;
        }

        .letter-container {
            max-width: 800px;
            width: 90%;
            margin: 60px auto 80px;
            padding: 40px;
            background-color: var(--letter-bg);
            border: 1px solid var(--letter-border);
            border-radius: 18px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 2.2s ease, transform 2.2s cubic-bezier(0.19, 1, 0.22, 1);
            transition-delay: 0.8s;
            z-index: 10;
        }

            .letter-container.show {
                opacity: 1;
                transform: translateY(0);
            }

        h1 {
            color: var(--starlight);
            text-align: center;
            margin-bottom: 30px;
            font-weight: 300;
            letter-spacing: 3px;
            text-shadow: 0 0 15px rgba(176, 160, 255, 0.4);
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 1.8s ease, transform 1.8s cubic-bezier(0.19, 1, 0.22, 1);
            transition-delay: 1.4s;
        }

            h1.show {
                opacity: 1;
                transform: translateY(0);
            }

        .letter-content {
            line-height: 1.9;
            font-size: 18px;
            font-weight: 300;
            opacity: 0;
            transition: opacity 2.5s ease;
            transition-delay: 2s;
        }

            .letter-content.show {
                opacity: 1;
            }

        p {
            margin-bottom: 20px;
            text-align: justify;
        }

        .signature {
            text-align: right;
            margin-top: 40px;
            font-style: italic;
            color: var(--star-accent);
        }

        /* 悬浮球（默认显示） */
        .player-fab {
            position: fixed;
            right: 20px;
            bottom: 22px;
            width: 62px;
            height: 62px;
            border-radius: 50%;
            background: radial-gradient(120px 120px at 35% 30%, rgba(176,160,255,0.35), rgba(176,160,255,0) 60%), linear-gradient(145deg, #1b1638, #100d2a 60%);
            border: 1px solid rgba(176,160,255,0.28);
            box-shadow: inset 0 0 20px rgba(176,160,255,0.12), 0 0 18px rgba(138,130,255,0.28), 0 12px 28px rgba(0,0,0,0.55);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            cursor: pointer;
            z-index: 120;
            opacity: 0;
            transform: translateY(8px) scale(0.95);
            transition: all .5s cubic-bezier(0.19, 1, 0.22, 1);
        }

            .player-fab::after {
                content: "";
                position: absolute;
                inset: -6px;
                border-radius: 50%;
                background: radial-gradient(120px 120px at 50% 50%, rgba(176,160,255,0.15), rgba(176,160,255,0) 60%);
                filter: blur(4px);
                pointer-events: none;
            }

            .player-fab .fab-icon {
                font-size: 22px;
                filter: drop-shadow(0 0 6px rgba(176,160,255,.45));
            }

            .player-fab.show {
                opacity: 1;
                transform: translateY(0) scale(1);
            }

        body.player-open .player-fab {
            opacity: 0;
            transform: scale(0.96);
            pointer-events: none;
        }

        /* 迷你播放器（展开面板），默认隐藏，展开时显示 */
        .mini-player {
            position: fixed;
            right: 20px;
            bottom: 20px;
            width: 340px;
            background-color: rgba(18,16,40,0.82);
            border: 1px solid rgba(176,160,255,0.22);
            border-radius: 14px;
            padding: 12px 12px 12px;
            box-shadow: 0 0 24px rgba(138,130,255,0.35), 0 16px 40px rgba(0,0,0,0.6);
            z-index: 130;
            opacity: 0;
            transform: translateY(12px) scale(0.98);
            transition: all 0.45s cubic-bezier(0.19, 1, 0.22, 1);
            pointer-events: none;
        }

            .mini-player.show { /* 初始可见性就绪 */
            }

        body.player-open .mini-player {
            opacity: 1;
            transform: translateY(0) scale(1);
            pointer-events: auto;
        }

        .player-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            font-size: 14px;
            color: var(--starlight);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

            .player-title .close-btn {
                background: transparent;
                border: none;
                color: rgba(255,255,255,0.85);
                font-size: 18px;
                cursor: pointer;
                padding: 2px 6px;
                line-height: 1;
                border-radius: 6px;
            }

                .player-title .close-btn:hover {
                    background: rgba(176,160,255,0.12);
                }

        .player-controls {
            display: flex;
            gap: 8px;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
        }

            .player-controls button {
                background: linear-gradient(135deg, #8a55e6, #5543b8);
                color: white;
                border: none;
                border-radius: 8px;
                padding: 6px 12px;
                cursor: pointer;
                font-family: 'Noto Serif SC', serif;
                font-size: 14px;
                letter-spacing: 1px;
                box-shadow: 0 4px 12px rgba(85, 67, 184, 0.35);
                transition: transform .2s ease, box-shadow .2s ease;
            }

                .player-controls button:hover {
                    transform: translateY(-1px);
                    box-shadow: 0 6px 16px rgba(85, 67, 184, 0.45);
                }

        .player-progress {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
        }

            .player-progress input[type="range"] {
                flex: 1;
                appearance: none;
                height: 4px;
                border-radius: 4px;
                background: rgba(138,130,255,0.3);
                outline: none;
            }

                .player-progress input[type="range"]::-webkit-slider-thumb {
                    appearance: none;
                    width: 12px;
                    height: 12px;
                    border-radius: 50%;
                    background: #b0a0ff;
                    box-shadow: 0 0 6px rgba(176,160,255,0.7);
                    cursor: pointer;
                }

        .player-time {
            font-size: 12px;
            color: rgba(255,255,255,0.85);
            min-width: 90px;
            text-align: right;
        }

        /* 展开时的半透明遮罩 */
        .player-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.35);
            backdrop-filter: blur(1px);
            z-index: 110;
            opacity: 0;
            pointer-events: none;
            transition: opacity .3s ease;
        }

        body.player-open .player-backdrop {
            opacity: 1;
            pointer-events: auto;
        }

        ::-webkit-scrollbar {
            width: 8px;
            background-color: rgba(0, 0, 0, 0.2);
        }

        ::-webkit-scrollbar-thumb {
            background-color: rgba(138, 130, 255, 0.3);
            border-radius: 4px;
        }

            ::-webkit-scrollbar-thumb:hover {
                background-color: rgba(138, 130, 255, 0.5);
            }

        .letter-content p {
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 1.5s ease, transform 1.5s ease;
        }

        .letter-content.show p {
            opacity: 1;
            transform: translateY(0);
            transition-delay: 2.2s;
        }

        .glow-text {
            color: white;
            text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px var(--star-accent), 0 0 20px var(--star-accent), 0 0 25px var(--star-accent);
            font-weight: 400;
        }

        /* 「祝你幸福」图片样式：适配深色星空 */
        .bless {
            text-align: center;
            margin: 26px 0 14px;
        }

            .bless img {
                display: inline-block;
                max-width: min(68%, 520px);
                height: auto;
                /* 关键1：反相成白字；2：混合为 Screen，黑色背景变“透明”，仅保留白字 */
                filter: invert(1) brightness(1.28) contrast(1.08) drop-shadow(0 0 8px rgba(176,160,255,0.35)) drop-shadow(0 0 18px rgba(176,160,255,0.22));
                mix-blend-mode: screen;
                opacity: .96;
            }
                /* 如果换成“透明底的白字 PNG/SVG”，加 is-transparent 类来关闭反相 */
                .bless img.is-transparent {
                    filter: brightness(1.05) drop-shadow(0 0 8px rgba(176,160,255,0.35)) drop-shadow(0 0 18px rgba(176,160,255,0.22));
                    mix-blend-mode: screen;
                }

        @media (max-width: 768px) {
            .bless img {
                max-width: 78%;
            }
        }

        @media (max-width: 768px) {
            .letter-container {
                margin-top: 40px;
                margin-bottom: 40px;
                padding: 25px;
            }

            h1 {
                font-size: 24px;
            }

            .letter-content {
                font-size: 16px;
            }

            .player-fab {
                right: 12px;
                bottom: 14px;
                width: 56px;
                height: 56px;
            }

            .mini-player {
                right: 12px;
                left: 12px;
                width: auto;
            }
        }

        .debug-info {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            padding: 5px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 9999;
            max-width: 300px;
            display: none;
        }

        /* 签名视频：靠右 + 初始隐藏 + 淡入过渡 */
        .sig-video {
            display: block;
        }

        .sig-right {
            margin-left: auto;
        }
        /* 让块级视频贴右对齐 */
        .sig-hidden {
            opacity: 0;
            transform: translateY(8px) scale(0.98);
            pointer-events: none;
            transition: opacity .6s ease, transform .6s cubic-bezier(0.19, 1, 0.22, 1);
        }

        .sig-show {
            opacity: 1;
            transform: translateY(0) scale(1);
            pointer-events: auto;
        }

    </style>

    <!-- 直开拦截：若非从首页进入且无会话标记，则跳回 index.html -->
    <script>
        (function () {
            try {
                const fromSameOrigin = document.referrer && new URL(document.referrer).origin === location.origin;
                const unlocked = sessionStorage.getItem('unlocked') === '1';
                if (!fromSameOrigin && !unlocked) {
                    location.replace('index.html');
                }
            } catch {
                location.replace('index.html');
            }
        })();
    </script>
</head>
<body>
    <div id="bgLayer" class="bg-layer"></div>
    <div class="bg-overlay"></div>

    <div id="whiteOverlay" class="white-overlay"></div>

    <div id="debugInfo" class="debug-info"></div>

    <!-- 音频 -->
    <audio id="bgMusic" preload="auto">您的浏览器不支持音频元素</audio>

    <!-- 悬浮球 -->
    <div id="playerFab" class="player-fab" title="音乐播放器">
        <span class="fab-icon">♫</span>
    </div>
    <!-- 展开遮罩 -->
    <div id="playerBackdrop" class="player-backdrop"></div>

    <!-- 迷你播放器（展开面板） -->
    <div id="miniPlayer" class="mini-player" title="音乐播放器">
        <div class="player-title">
            <span id="trackTitle">-</span>
            <button id="btnClose" class="close-btn" aria-label="关闭">×</button>
        </div>
        <div class="player-controls">
            <button id="btnPrev" type="button">上一曲</button>
            <button id="btnPlayPause" type="button">暂停</button>
            <button id="btnNext" type="button">下一曲</button>
        </div>
        <div class="player-progress">
            <input id="progress" type="range" min="0" max="0" step="0.1" value="0" />
            <div class="player-time"><span id="currentTime">00:00</span> / <span id="totalTime">00:00</span></div>
        </div>
    </div>

    <div class="content-wrapper">
        <div id="letterContainer" class="letter-container">
            <h1 id="letterTitle">致王舒歆</h1>
            <div id="letterContent" class="letter-content">
                <!-- 省略：正文保持不变 -->
                <p>我依旧清晰地记得初次产生交集的场景。</p>
                <p>那次换座位，我又被排到最后一个，只剩下你前面和讲台上两个选择，于我而言，在小学期间已经坐够讲台了，所以我就挑了你前面的那个位置。</p>
                <p>说实话，其实当时我并不太清楚你是谁，甚至到了你前面才把你的脸和你的名字联系起来。你学习挺好——尽管你自己不这么说，但在我眼里，你的成绩已经是我梦寐以求的了。而且你的性格也很好，和我一样带着一点天然呆和幼稚，还是一个乐天派，显得跟他们有些不一样。</p>
                <p>你是音乐课代表，唱歌好听，画画也厉害，还会写书法。当时的我还是太年轻了，跟你在一块居然没有自卑，觉得“哇，这个人好厉害，怎么什么都会？”可能这就是你亲和力的体现。还记得在初一一开学的那次运动会上我们坐在一起，聊了很多事，但已经全都忘记了。师达的运动会又臭又长是真的，但没有哪个学校比它更重视体育也是真的。还记得看你站起身，说要去参加项目的背影。敢去做我当时最害怕的事，我还是很佩服你的。那天天蓝得不真切，风吹过灌木丛的沙沙声和学生们窃窃私语的声音构成了那天的底噪。就在一片欢呼声和混乱中，运动会结束了。</p>
                <p>如你所见，我的体育在当时很糟糕，跑一圈之后就累得不行了，在别人一千米成绩飞速进步的时候我却还在七分钟左右徘徊；当别人能拉起四五个引体的时候我连杆子都挂不住……这不由得使我讨厌体育课，而在一个体育课如此之多的学校里，每天都有些烦躁。</p>
                <p>当然，体育是一方面，另一方面是学习。李润找过我很多次，我当时以一个很高的分数考到实验班，又很快跑到了500名以外，他并不是很满意。现在想想，当时其实我是不知道怎么学习的，之前只是做题，根本没想过学习这种复杂的事。错题不改，也不复习，考成那样也是理所当然的。</p>
                <p>后来渐渐的，我们似乎和成绩绑定了，被强行分裂成两部分，一个是课内的成绩，一个是课余生活。然而在师达任何的课余都被视为“罪”，成绩决定人，决定“社会地位”。成绩差的好像就是应该被看不起，扣分多的就是在给并不团结的团体抹黑。</p>
                <p>我想，如果我在那个学校呆了三年，可能我的内心会留下很深的伤疤吧。或许在那里心里单纯的人更难受到伤害，但一旦受到伤害，造成的后果也更严重。我作为一个纯正乐天派，其实初一初二的时候没有感到生活有多压抑，遇见什么事让自己笑笑就过去了，难过就去一个人哭一会。现在我才意识到那其实就是在一个重视成绩的群体里被渐渐边缘化的情况。你也一样，心思太过单纯，结果被别人利用，付出了惨痛的代价。</p>
                <p>到了初二，不出意外的在开学前得到了七班班主任的电话，我其实还挺高兴的，因为小学的一个好朋友就在七班。我们前两天还刚见过面。七班整体氛围挺好，男生之间也很融洽，我交到了更多朋友，成绩有了进步，虽然并不亮闪闪，但我知道正在缓慢的进步着。有一次考到了三百多名，我很开心，但是还是不够和你坐到一个考场去。班主任对我耐心多了，也许是因为周边的同学跟我差不多，也许是因为她默认我就是这样一个人。</p>
                <p>但是，我很不能理解的一件事是她在我要走前两三个月搞了一个排名，大体上就是投票出班里最闹腾的几个同学，并把他们安排到角落里去。还没开始投票我就知道这次可能是我在师达排名最高的一次。结果不出所料，我被封印在了教室的右后角。</p>
                <p>向左转头能看见窗户。白天能看见青葱的绿托住蓝色的天，下午能看见十万只金喇叭冲破云霄齐齐响起，晚上能看见宁静的黑被灯烫出几个白色的斑点。看见窗户就想起你一直坐的那个角落，你总是选后排靠窗的位置（王的故乡），还说要写一篇作文叫“三年的角落”。这个目标，不知道你还记得吗。</p>
                <p>我还记得西操场的晚霞。太阳鼓足力气试图向穹顶爬去，另一个看不见的阴翳在躲在地平线以下死死地拖住太阳的双腿，两个人在天边开始搏斗，动脉喷涌出鲜红的血液染红了云彩，由此便成了夕烧。天上的风吹动地上的沙，太阳的尸体慢慢的冷下去，天边一片寂静，我坐在主席台上，一个人看着天边一切的杀戮和新生，直到夜色来跟我换班。那时，我看见你在踢足球。</p>
                <p>你是我少见的爱运动的女生，上了高中和大学以后身边的同学都非常懒，更别提和男生踢球了。每当看见你们在球场上驰骋，我就会想起那个夏天的下午，我穿着球衣坐在椅子上，直到结束也没有人喊我来换班。后来才知道李润早就说了不让我上。</p>
                <p>除此之外，我想加入轮滑社的申请也被他直接驳回，但我成了每天坚持擦黑板的人，当然擦不好还有惩罚。我想，或许一直恨他也没有用，于是我试图让风把我手里的怨恨像带走蒲公英种子那样带走。</p>
                <p>最后一晚，我抱着被褥回到七班，收拾好了寝室的所有小物件，突然想起了初一暑假前的最后一天。期末考试已经过去，广播里正在播放处分决定，几个男生被李润提溜在后面站着，我抱着枕头，脚底放着被褥，不知道自己该去哪，会离开吗？我也说不清楚，但是又不是不舍，跟我挺聊得来的人除了你之外并不多了。我就这样拎着行李，回家了。</p>
                <p>那天晚上也一样，很巧的是我遇到了一个一班的同学，他拿了出门条要出门。我不记得我有回头再看吗？总之是骑车离开了学校，就和之前一样。</p>
                <p>我留了几封信在一些同学的桌洞里，应该也给你留了，本来想再叫你出来好好告个别的，最后也没有时间。一个假期过去，疫情的到来让我既不能转去天津，也不能不上师达的课，所以网课期间我又秽土转生回来加入七班的网课了。这种虚拟的链接并不长，很快就到了天津线下办手续，入学的时候。</p>
                <p>去的是南开区一个相当新的学校，我们是那所学校的第一届毕业生。老师是其他学校淘汰下来重组的老师，教育条件和北京比还是差远了。同学抽烟喝酒谈恋爱啥都有，还有很多很多在师达没见过的抽象操作。打游戏是最常见的，没有满教室疯跑就不错了。</p>
                <p>男生都是混混，女生都是太妹，在这样一个环境里，每天面对各种挑衅和找茬，我“善良”的外衣似乎被证明只是胆小。虽然不太适应这种混乱的环境，但是我的成绩却一飞冲天——没有对比就没有伤害。</p>
                <p>教育，尤其是青少年早期的教育对一个人性格塑造真的很重要，我说的并不是语数英这种学术上的教育，而是教做人。我明白师达很努力的想要做到这一点，可是它过于看重成绩，而忽视了老师本身的人品。在学生面前破防发飙，骂学生和家长，无条件的支持学习更好的一方，甚至出手打人——这都不应当是一个老师的所作所为，只要他还是一个老师。</p>
                <p>我到了天津才明白差的学校是什么样，他们根本就没有规矩这个概念，弄的课堂混乱不堪。一群精神小伙整日在外面惹是生非，有几次惹到了真的道上的人又是一哭二闹三上吊的给人道歉。但是也并没有吸取任何教训，之后该啥样还啥样。细细想来是一种悲哀，教育的缺失让他们在十五岁决定放弃自己的人生而不自知，不过换句话说，如果没有他们的放弃，也没有我们现在的成绩，竞争将会更加激烈，同时会拉低人均教育资源，社会就是这样残酷。</p>
                <p>在初三的某一天，在一个宁静的清晨，我迎来了我人格的第一次剧变。隔壁班大姐早上来坐在我位子上跟别人谈天说地，我让她起来。忘了中途的过程，最后发展成她要找人打我。一开始我以为她又是跟其他人一样只有嘴厉害，可听着周围同学讲述她过往事迹，我的心里也逐渐升起了一阵烦躁。不多时，两个瘦高的身影就在门口出现了，让我出去，我自然是懒得搭理，班主任过来把他们两个叫走了，顺便帮我把这件事解决了。</p>
                <p>那一上午我都没有集中注意力，心里感情很复杂。她私下还在跟我叫嚣，一方面，我害怕这种事，另一方面，对自己窝囊的悲叹正在一点点转化成愤怒。为什么我还要遇上这种事？</p>
                <p>愤怒在心里越积越多，最后竟发展成了不可遏制的杀意。我买了一把匕首，廉价的仿制品，放到现在我肯定不会买这种便宜货，但在当时，我好像明白了我心中一直缺少的是安全感。在之前的日子里，我总会被李润叫去莫名其妙骂一顿，遇上学生会的“大官们”对一件小事的存心刁难，忍受住李润不断的暗示要给我一个处分。我之前好像忍耐过头了，当时的我只想把心中的怒火全撒在她一个人身上。之前的我，是胆小鬼吗？</p>
                <p>不过，后面她确实没有找人打我，老师还是把这个事很好地解决了。匕首就静静躺在书包的夹层里，从来不拿出来，只有背上书包感受到刀格抵住后背，才有了一丝安全感。</p>
                <p>慢慢的，我的胆子变得越来越大，比起忍着或者吵架，遇到事情我更喜欢直接一拳打在对面鼻梁骨上，当时我觉得挺好，已经不需要再怕事了。我努力锻炼身体，每天都跑步，举哑铃，每天都和朋友在草地上摔跤。我加倍锻炼，不仅是为了能战胜朋友们，也是追寻着做一件痛苦的事情能带给我的意义，就像当年我看你一样。在那所学校里，有时我会想起你，想起七班的同学，想起在银杏树下的那些日子，新的学校里，似乎也有一棵银杏树。</p>
                <p>在初三那一年，因为学习成绩的提升带给我的自信，我的人格再一次迎来剧变。从一个外向又有点自卑和胆小的人变成了乐观开朗又经常拳脚相向的人。成也学业，败也学业，这或许就是中国应试教育体制下学生的悲哀。那段时间和你突然断了联系，一看被你拉黑了，我小小的心灵里涌现了大大的疑问。一路突破坐到第一考场时，我会想起你。在中考前无数个日日夜夜里，留下来参加晚自习，窗外坏掉的路灯像一个担子一样挑着天上的明月，随着它渐渐洒向大地，我睡着了。</p>
                <p>在中式伤痛下交到的朋友往往也共享着升学焦虑，这是国内学生独有的一种感受。每个人在自己的伤口上撒盐，放黄油，蒜和迷迭香，小火煎至金黄，摆上餐桌，炫耀自己所遭受的伤痛是多么的大。他们把我做成表情包，在每一次考试前转发我这个“人形锦鲤”，围着我的卷子叽叽喳喳，惊叹于我又做出一道他们不会的题。就这样，我从这所学校毕业了，简直和之前判若两人。</p>
                <p>不出意外的被市重点录取了，开学我走进教室，坐在了后排一个男生的旁边，后来他成了我最好的朋友。在一班看见了孙博语，他看见我的时候好像有一种无奈又释怀的感觉，还在十二班看见了我的一个小学同学，腼腆着接近不敢相认。不管我们前半段人生曾经分开多么远，最终我们还是在这一点相聚了，或许这就是缘分。从我离开师达以后，好像没想到有一天能和你再见面的。</p>
                <p>有一天，刘博修发朋友圈提到了你，他说，有一次你帮他撩头发，从此俘获了他的芳心。我也突然想起了你，想起了西操场在冬天凛冽的风。于是问了他你的联系方式，他说没有，这时候我才意识到你可能是把账号注销了。不管出于什么原因吧，我管陈岱兴要了你现在的这个号，你居然能认出我是谁，我还是很欣慰的。但是得知你的身体状况好像不是很乐观，又让我有些担心。</p>
                <p>在高中，我认识了更多人，交到了更多朋友也学到了很多知识。初中时那个孩子一定想不到他以后的样子，我给过去的我留了一个秘密。</p>
                <p>班上绝大多数男生组成了一个大团体，原来同学之间是可以这么和睦相处，原来老师并不会故意找你的茬，原来晚霞可以不是鲜血淋漓的厮杀而是温柔告别。当晚风吹动逸夫楼顶的旗杆时，我听见大钟响了十三下。我学着收起那些刺，但并不把它们拔掉，而是藏在我的体内，随时可以重新伸出来。这，才是善良。</p>
                <p>高中梦也似的过去了，高考出分后，每个人都忙着填报志愿，我的成绩算是小有遗憾，来到了中国海洋大学。到了大学，感觉人与人之间的距离似乎变远了，再也没有高中时的感觉了。因为目标是争取一个保研名额，我的大学生活过的可能有些无聊。每一科都不能落下，要尽力做到最好。</p>
                <p>中国人的一生一直很“关键”——早教，幼儿园，幼升小，一年级，二年级，小升初，初中，高中，高考后的暑假，本科，研究生，就业或者读博，工作，晋升……我们的成长好像一个洋葱，一层层把自己包裹，等社会认可了你的成熟，你早就丢失了你的心。</p>
                <p>但是，王舒歆，你有机会去打破这种定势。为什么不长成胡萝卜或者土豆呢？这就是通识教育可以带给你的选择。回顾过往，从小学没心没肺的年纪到现在似乎就是一瞬间。</p>
                <p>我突然想到一颗属于我的树。宽大的树杈，低矮的枝桠使得它是我唯一能爬上去的树。随着转学去海淀区，我和它这一分别就是13年。如今，我再见它，也爬不上去了。高高的树干直插天空，风吹过树林，摇曳的树叶让我看不清上面的枝桠。会不会有一个年幼的我依旧坐在上面呢？我不知道，祝他安好吧。附近的街道全变了，之前我家楼下是一条土路，小小的我午觉睡到下午两三点，阳光已经填满了阳台，正向我的床慢慢走来。走出卧室，客厅里每处都闪耀着金色的光辉，太阳斜射在电视机上，还有半个小时就要播我喜欢的动画片。远处山上有一个城堡似的建筑，到现在还在那里矗立，我也不知道是干什么的。</p>
                <p>我始终没有忘记你给我提的那些建议，其中专时专用真的有用。经过五年的成长，我在这里也给你一条建议：</p>
                <p>尝试并坚持一项体育运动，最好是日常就能完成的，比如跑步。有一个健壮的身体带给你的提升不只是增强自信。你将变得更有勇气，并且在一些极端情况下也不会慌张。</p>
                <p>现在是你的体力巅峰期，你以后再也不会比现在更有更多的活力和体能。我去跑步的时候经常能收到大爷们羡慕的眼光。我们好比朝阳，热烈无比，光芒四射，正在往山头上去呢。</p>
                <p>但是，我们每时每刻都是朝阳，其实无时无刻不是落日。当太阳向山巅升起之时，亦是垂垂老矣落向谷底之日。我们总有一天要走到山顶的，万物皆有进程。</p>
                <p>现在，似乎分别的进程要先到来了，日暮即将降临了，夕阳把我们的残影越拉越长，只好在日落前告别了，总有没说出的话，会藏在这篇文章里。大钟再次为我敲了十三下，我们过去的时光好似虚幻。</p>
                <p>王舒歆，我们的人生有可能从此以后再无交集，我只希望你不要忘了我。</p>
                <div class="bless">
                    <img class="is-transparent" src="assets/images/bless.png" alt="祝你幸福">
                </div>
                <p class="signature">一个初出茅庐，开始探索世界的毛头小子</p>
                <p class="signature">于2025年8月20日，北京，中国</p>
                <video id="sigVideo" class="sig-video sig-right sig-hidden" playsinline muted preload="auto"
                       style="width:min(68%,520px);mix-blend-mode:screen;filter:drop-shadow(0 0 8px rgba(176,160,255,.35)) drop-shadow(0 0 18px rgba(176,160,255,.22));">
                    <source src="assets/anim/signature_dark_gold.webm" type="video/webm">
                </video>
            </div>
            <div id="homeLink" class="home-link">
                <a href="index.html">返回首页</a>
            </div>
        </div>
    </div>

    <script>
        // 播放队列（随机首曲，其余两首依次播放，循环）
        let playlist = [];
        let currentTrack = 0;

        // 改为 DOMContentLoaded；用 try/finally 确保遮罩一定会被移除
        document.addEventListener('DOMContentLoaded', () => {
            try {
                createStars(200);
                setupBackgroundFromSession();
                setupPlaylist();
                startMeteorShower();
                setupSignatureVideoGate(); // 底部触发签名视频播放
            } catch (e) {
                console && console.error && console.error(e);
            } finally {
                startEntryAnimation();
                // 兜底：若出现异常，最多 5s 后强制移除白色遮罩
                setTimeout(() => {
                    const overlay = document.getElementById('whiteOverlay');
                    if (overlay) overlay.style.opacity = '0';
                }, 5000);
            }
        });

        // 滑到底部 → 延迟2秒 → 淡入并播放签名视频（含自动播放拦截兜底）
        function setupSignatureVideoGate() {
            const v = document.getElementById('sigVideo');
            if (!v) return;

            try { v.pause(); } catch { }
            v.currentTime = 0;

            const threshold = 16; // 距底部阈值(px)
            let scheduled = false; // 只触发一次

            const startWithDelay = () => {
                if (scheduled) return;
                scheduled = true;
                window.removeEventListener('scroll', onScroll);

                setTimeout(() => {
                    v.classList.remove('sig-hidden');
                    v.classList.add('sig-show');

                    v.play().catch(() => {
                        // 若被策略拦截，监听首次交互补播
                        const once = () => {
                            v.play().catch(() => { });
                            ['click', 'touchstart', 'keydown'].forEach(ev => document.removeEventListener(ev, once));
                        };
                        ['click', 'touchstart', 'keydown'].forEach(ev => document.addEventListener(ev, once, { once: true }));
                    });
                }, 2000); // 延迟2秒
            };

            const onScroll = () => {
                const doc = document.documentElement;
                const scrollTop = window.pageYOffset || doc.scrollTop || 0;
                const viewport = window.innerHeight || doc.clientHeight || 0;
                const scrollBottom = scrollTop + viewport;
                const docHeight = Math.max(doc.scrollHeight, doc.offsetHeight, doc.clientHeight);
                if (scrollBottom >= docHeight - threshold) startWithDelay();
            };

            window.addEventListener('scroll', onScroll, { passive: true });
            // 若页面很短初始即在底部，稍后尝试一次
            setTimeout(onScroll, 80);
        }

        function logDebug(msg) { const d = document.getElementById('debugInfo'); if (d.style.display === 'block') d.innerHTML += '<br>' + msg; }

        function createStars(count) {
            document.querySelectorAll('.star').forEach(s => s.remove());

            const isMobile = window.matchMedia('(max-width: 768px)').matches;
            const sparkleRatio = isMobile ? 0.18 : 0.25; // 更少出现光束的星
            for (let i = 0; i < count; i++) {
                const s = document.createElement('div');
                s.className = 'star';

                const x = Math.random() * 100;
                const y = Math.random() * 100;

                // 尺寸：少量更大的星
                const isBig = Math.random() < 0.12;
                const size = isBig ? Math.random() * 3 + 2 : Math.random() * 2 + 0.8;

                // 更长、更分散的闪烁周期与延迟
                const dur = 4.8 + Math.random() * 3.4; // 4.8s ~ 8.2s
                const delay = Math.random() * 3.5;
                const brightness = 0.6 + Math.random() * 0.35;

                Object.assign(s.style, {
                    left: `${x}vw`,
                    top: `${y}vh`,
                    width: `${size}px`,
                    height: `${size}px`,
                    opacity: brightness
                });
                s.style.setProperty('--size', `${size}px`);
                s.style.setProperty('--delay', `${delay}s`);
                s.style.setProperty('--dur', `${dur}s`);
                s.style.setProperty('--spikeScale', isBig ? '1.25' : '1');

                // 只有部分星添加光束效果
                const isSpark = Math.random() < sparkleRatio;
                if (isSpark) {
                    s.classList.add('spark');

                    // 初始化一次角度和是否显示十字
                    randomizeSpike(s);

                    // 每次 twinkle 动画结束，随机一个新方向和是否十字
                    s.addEventListener('animationiteration', (ev) => {
                        if (ev.animationName === 'twinkle') {
                            randomizeSpike(s);
                        }
                    });
                }

                document.body.appendChild(s);
            }
        }

        // 为“会闪”的星随机一个方向；有时是单束，有时是不完美十字
        function randomizeSpike(el) {
            const angle = Math.floor(Math.random() * 360);      // 主方向
            const cross = Math.random() < 0.55;                 // 55% 概率出现十字
            const delta = (Math.random() * 20 - 10);            // 与直角的微偏差，更自然

            el.style.setProperty('--rot', `${angle}deg`);
            el.style.setProperty('--rot2', `${angle + 90 + delta}deg`);

            if (cross) el.classList.add('cross');
            else el.classList.remove('cross');
        }

        function setupBackgroundFromSession() {
            let bg = sessionStorage.getItem('currentBackground');
            if (!bg) { const arr = ['assets/images/bg1.jpg', 'assets/images/bg2.jpg']; bg = arr[Math.floor(Math.random() * arr.length)]; }
            const layer = document.getElementById('bgLayer');
            const img = new Image();
            img.onload = () => layer.style.backgroundImage = `url('${bg}')`;
            img.onerror = () => { layer.style.backgroundImage = 'none'; layer.style.backgroundColor = '#0a0821'; };
            img.src = bg;
        }

        function setupPlaylist() {
            // 全部曲目
            const all = [
                { src: 'assets/audio/nengbanibizuoxiarima.mp3', title: '能把你比作夏日吗' },
                { src: 'assets/audio/xiexie.mp3', title: '谢谢' },
                { src: 'assets/audio/yuhuating.mp3', title: '雨花亭' }
            ];

            // 首曲固定为“能把你比作夏日吗”
            const first = all.find(t => t.src.includes('nengbanibizuoxiarima.mp3'));
            // 其余两首随机排列
            const rest = all.filter(t => t !== first).sort(() => Math.random() - 0.5);

            playlist = [first, ...rest];
            currentTrack = 0;
            loadAndPlayCurrent(true);

            const audio = document.getElementById('bgMusic');
            wireProgressEvents(audio);

            // 循环播放
            audio.onended = () => {
                currentTrack = (currentTrack + 1) % playlist.length;
                loadAndPlayCurrent(false);
            };

            setupUserInteractionPlay();
            setupFabToggle(); // 悬浮球展开/收起
        }

        function loadAndPlayCurrent(fadeIn) {
            const audio = document.getElementById('bgMusic');
            const titleEl = document.getElementById('trackTitle');
            const prog = document.getElementById('progress');
            const cur = document.getElementById('currentTime');
            const tot = document.getElementById('totalTime');

            titleEl.textContent = playlist[currentTrack].title;
            prog.value = 0; prog.max = 0;
            cur.textContent = '00:00'; tot.textContent = '00:00';

            while (audio.firstChild) audio.removeChild(audio.firstChild);
            const src = document.createElement('source');
            src.src = playlist[currentTrack].src; src.type = 'audio/mpeg';
            audio.appendChild(src);
            audio.load();
            sessionStorage.setItem('currentMusic', playlist[currentTrack].src);

            if (fadeIn) {
                fadeInMusic(1800);
            } else {
                audio.play().then(() => {
                    document.getElementById('btnPlayPause').textContent = '暂停';
                }).catch(() => { });
            }
        }

        function startEntryAnimation() {
            const overlay = document.getElementById('whiteOverlay');
            const container = document.getElementById('letterContainer');
            const title = document.getElementById('letterTitle');
            const content = document.getElementById('letterContent');
            const homeLink = document.getElementById('homeLink');
            const fab = document.getElementById('playerFab');

            overlay.style.opacity = '1';
            setTimeout(() => {
                overlay.style.opacity = '0';
                setTimeout(() => container.classList.add('show'), 500);
                setTimeout(() => title.classList.add('show'), 1200);
                setTimeout(() => content.classList.add('show'), 1800);
                // 展示悬浮球（默认球形）
                setTimeout(() => { fab.classList.add('show'); }, 2200);
            }, 800);
        }

        function fadeInMusic(duration) {
            const audio = document.getElementById('bgMusic');
            const btn = document.getElementById('btnPlayPause');
            audio.volume = 0;
            audio.play().then(() => {
                btn.textContent = '暂停';
                const steps = 30, step = 0.6 / steps, dt = duration / steps;
                let i = 0; const t = setInterval(() => {
                    i++; if (i >= steps) { clearInterval(t); audio.volume = 0.6; return; }
                    audio.volume = i * step;
                }, dt);
            }).catch(() => { });
        }

        function setupUserInteractionPlay() {
            const a = document.getElementById('bgMusic');
            const btn = document.getElementById('btnPlayPause');

            ['click', 'touchstart', 'keydown'].forEach(ev => {
                document.addEventListener(ev, () => {
                    if (a.paused || a.volume === 0) {
                        fadeInMusic(1200);
                    }
                }, { once: true });
            });

            document.getElementById('btnPrev').addEventListener('click', () => {
                currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
                loadAndPlayCurrent(true);
            });
            btn.addEventListener('click', () => {
                if (a.paused) {
                    if (a.volume === 0) fadeInMusic(800);
                    else a.play().then(() => btn.textContent = '暂停');
                } else {
                    a.pause(); btn.textContent = '播放';
                }
            });
            document.getElementById('btnNext').addEventListener('click', () => {
                currentTrack = (currentTrack + 1) % playlist.length;
                loadAndPlayCurrent(true);
            });
        }

        // 悬浮球展开/收起
        function setupFabToggle() {
            const body = document.body;
            const fab = document.getElementById('playerFab');
            const backdrop = document.getElementById('playerBackdrop');
            const closeBtn = document.getElementById('btnClose');

            function open() { body.classList.add('player-open'); }
            function close() { body.classList.remove('player-open'); }

            fab.addEventListener('click', open);
            closeBtn.addEventListener('click', close);
            backdrop.addEventListener('click', close);
            document.addEventListener('keydown', (e) => { if (e.key === 'Escape') close(); }, false);
        }

        // 进度条与时间显示
        function wireProgressEvents(audio) {
            const prog = document.getElementById('progress');
            const cur = document.getElementById('currentTime');
            const tot = document.getElementById('totalTime');

            audio.addEventListener('loadedmetadata', () => {
                prog.max = isFinite(audio.duration) ? audio.duration : 0;
                tot.textContent = formatTime(audio.duration || 0);
            });

            audio.addEventListener('timeupdate', () => {
                if (!isNaN(audio.currentTime)) {
                    prog.value = audio.currentTime;
                    cur.textContent = formatTime(audio.currentTime);
                    if (isFinite(audio.duration)) {
                        prog.max = audio.duration;
                        tot.textContent = formatTime(audio.duration);
                    }
                }
            });

            prog.addEventListener('input', () => {
                if (isFinite(audio.duration)) {
                    audio.currentTime = parseFloat(prog.value);
                }
            });
        }

        function formatTime(sec) {
            if (!isFinite(sec)) return '00:00';
            const s = Math.max(0, Math.floor(sec));
            const m = Math.floor(s / 60);
            const r = s % 60;
            return `${m.toString().padStart(2, '0')}:${r.toString().padStart(2, '0')}`;
        }

        // 改进流星：星头先出现，随后带出拖尾；全程匀速；尾部延迟淡出
        function spawnMeteor() {
            const m = document.createElement('div');
            m.className = 'meteor';

            const tail = document.createElement('div');
            tail.className = 'meteor-tail';

            const head = document.createElement('div');
            head.className = 'meteor-head';

            m.appendChild(tail);
            m.appendChild(head);

            const angle = 18 + Math.random() * 20;
            const baseTravel = 220 + Math.random() * 520;
            const baseMs = 900 + Math.random() * 1100;
            const tailBonus = 120 + Math.random() * 220;
            const speed = baseTravel / baseMs;
            const totalTravel = baseTravel + tailBonus;
            const totalMs = totalTravel / speed;

            const tailLength = 80 + Math.random() * 180;
            const thickness = Math.random() < 0.2 ? 3 : 2;
            tail.style.width = `${tailLength}px`;
            tail.style.height = `${thickness}px`;

            const vw = window.innerWidth, vh = window.innerHeight;
            const startFromTop = Math.random() < 0.25;
            const startX = startFromTop ? (Math.random() * vw * 0.6) - vw * 0.1 : (-vw * 0.15 + Math.random() * vw * 0.25);
            const startY = startFromTop ? (-vh * 0.15) : (Math.random() * vh * 0.55);

            const rad = angle * Math.PI / 180;
            const endX = startX + Math.cos(rad) * totalTravel;
            const endY = startY + Math.sin(rad) * totalTravel;

            m.style.transform = `translate3d(${startX}px, ${startY}px, 0) rotate(${angle}deg)`;
            m.style.transition = `transform ${totalMs}ms linear`;
            head.style.opacity = '0';
            tail.style.opacity = '0';
            tail.style.transform = `translateY(-50%) scaleX(0)`;

            document.body.appendChild(m);

            requestAnimationFrame(() => {
                m.style.transform = `translate3d(${endX}px, ${endY}px, 0) rotate(${angle}deg)`;
            });

            const headInMs = 180 + Math.random() * 120;
            head.style.transition = `opacity ${headInMs}ms ease-out`;
            requestAnimationFrame(() => { head.style.opacity = '1'; });

            const tailGrowDelay = 120;
            const tailGrowMs = 260 + Math.random() * 240;
            setTimeout(() => {
                tail.style.transition = `transform ${tailGrowMs}ms ease-out, opacity ${tailGrowMs}ms ease-out`;
                tail.style.opacity = '1';
                tail.style.transform = `translateY(-50%) scaleX(1)`;
            }, tailGrowDelay);

            const headOutMs = 220 + Math.random() * 180;
            const headOutStart = baseMs - Math.min(headOutMs - 40, 360);
            setTimeout(() => {
                head.style.transition = `opacity ${headOutMs}ms ease-out`;
                head.style.opacity = '0';
            }, Math.max(0, headOutStart));

            const tailOutMs = 400 + Math.random() * 400;
            const tailOutStart = totalMs - tailOutMs;
            setTimeout(() => {
                tail.style.transition = `opacity ${tailOutMs}ms ease-out`;
                tail.style.opacity = '0';
            }, Math.max(0, tailOutStart));

            setTimeout(() => { m.remove(); }, totalMs + 120);
        }

        function startMeteorShower() {
            function next() {
                const gap = 700 + Math.random() * 2600;
                setTimeout(() => {
                    spawnMeteor();
                    if (Math.random() < 0.2) setTimeout(spawnMeteor, 120 + Math.random() * 260);
                    next();
                }, gap);
            }
            next();
        }

        window.addEventListener('resize', () => createStars(200));
    </script>
</body>
</html>